<?php $productsByCommercants = $this->getProductsByCommercant(); ?>
<?php $tmpCommercantId = 0; ?>
<?php if (count($productsByCommercants) > 0) : ?>
<div class="searchresults container">
    <div class="row">
        <div class="col-xs-12">
            <div class="text-center">
                <?php foreach ($productsByCommercants as $commercantId => $products) { ?>
                <?php
                    if($commercantId!=null){
                        $shop_info = Mage::helper('apdc_commercant')->getInfoShopByCommercantId($commercantId);
                ?>
                <div class="commercant-search-result">
                <?php if (!empty($shop_info)) : ?>
                    <?php $delivery_days = $shop_info['delivery_days']; ?>
                    <div class="title-block row">
                        <div class="col-lg-6 col-md-12 text-left">
                            <div class="photo-commercant">
                                <img class="img-responsive" src="<?= $shop_info["thumbnail_image"] ?>">
                            </div>
                            <h3><?php echo $this->getCommercantName($products[0]); ?></h3>
                        </div>
                        <div class="col-lg-6 col-md-12 text-right delivery-days">
                            <?php $availability = $this->getChild('product_availability'); ?>
                            <?php if ($availability) : ?>
                                <?php echo $availability->setAvailability($delivery_days)
                                        ->toHtml(); ?>
                            <?php endif; ?>
                        </div>
                    </div>
                    <?php endif; ?>
                    <ul class="owl-carousel apdc-products-grid row">
                        <?php
                            foreach ($products as $product) { 
                                $this->getChild("card-product")->setData("product", $product);
                                echo $this->getChildHtml('card-product', false);
                            }
                        ?>
                    </ul>
                </div>
                <?php }} ?>
            </div>
        </div>
    </div>
</div>
<script>
    $j(document).ready(function() {
      $j('.owl-carousel').owlCarousel({
            itemsScaleUp : false,
            pagination:false,
            autoPlay : false,
            navigation : true,
            afterInit:function() {
                alignProductGridActions();
            },
            responsiveClass:true,
            responsive:{
                0:{
                    items:1,
                    nav:true
                },
                420:{
                    items:5,
                    nav:true
                },
            },
            navText: ['<i class="fa fa-angle-left">','<i class="fa fa-angle-right">'],
      });  
    });
</script>
<?php endif; ?>
