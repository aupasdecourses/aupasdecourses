{% extends 'ApdcApdcBundle::base.html.twig' %}
{% use 'ApdcApdcBundle::menu/default.html.twig' %}

{% block body %}
<div class="container">
	<div class="progress">
		<div class="progress-bar" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 60%;">
	    	<span>60% Complete</span>
		</div>
	</div>
	{{ form_start(form) }}
	<div class="row">
		<div class="col-sm-10">
			<h1> Remboursement : Input des infos </h1>
		</div>
		<div class="col-sm-2">
			<button type="submit" name="submit" value='next' class="btn btn-default right">Next</button>
		</div>
	</div>
		{% for merchant_id, merchant_part in order %}
			<h2>{{merchant_part.merchant.name}}</h2>
			<div class='row'>
				<div id='{{merchant_id}}-ticket-img' class='merchant-ticket col-sm-4' style='width: 350px; height: 400px;' value='{{merchant_part.merchant.ticket}}'></div>
				<div class="col-sm-8">
					<table id='{{merchant_id}}' class='merchant table'>
						<tr>
							<th>Produit</th>
							<th>Description</th>
							<th>Quantité</th>
							<th>Prix Unitaire</th>
							<th>Total Commande</th>
							<th>Total Ticket</th>
							<th>Différence</th>
							<th>Commentaire</th>
						</tr>
						{% for product_id, product in merchant_part.products %}
							<tr>
								<td>{{product.nom}}</td>
								<td>{{product.description}}</td>
								<td>{{product.quantite}}</td>
								<td>{{product.prix_kilo}}</td>
								<td>
									<span id='{{product_id}}-total'>{{product.prix_total }}</span>
								</td>
								<td>
									<input id='{{product_id}}-ticket-input' class='ticket-input' type='text' name='form[{{product_id}}][ticket]' value='{{product.refund_prix | round(2,'floor')}}' />
								</td>
								<td>
									<p id='{{product_id}}-diff' class='diff'>{{product.refund_diff | round(2,'floor')}}</p>
								</td>
								<td>
									<textarea class="noEnterSubmit" rows="1" cols="18" name="form[{{product_id}}][comment]"> {{product.refund_com}}</textarea>
								</td>
							</tr>
						{% endfor %}
						<tr>
							<th colspan='4'>TOTAL</th>
							<td><p id='{{merchant_id}}-total'>{{merchant_part.merchant.total}}</p></td>
							<td><p id='{{merchant_id}}-ticket-total'></p></td>
							<td><p id='{{merchant_id}}-diff-total'></p></td>
							<td></td>
						</tr>
					</table>
				</div>
			</div>
		{% endfor %}
	<!--	<input type="hidden" name="_csrf_token"
					   value="{#{ csrf_token('authenticate') }#}">
	-->
		<div class="row">
			<button type="submit" name="submit" value='submit' class="btn btn-default right">Submit</button>
		</div>

			{{ form_end(form) }}
</div>
{% include 'ApdcApdcBundle::menu/footer.html.twig' %}
{% endblock %}
{% block javascripts %}
<script type="text/javascript">

$('text').keypress(function(event) {
	    if (event.keyCode == 13) {
			        event.preventDefault();
					    }
});

</script>
{% endblock %}
