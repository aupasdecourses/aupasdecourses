{% extends 'base.html.twig' %}
{% use '/menu/default.html.twig' %}

{% block body %}

<div class="container">
	<hr>
	<h1>Remboursement : </h1><br/>
	{% for store, merchants in stores %}
	<table style="width: 100%">
		<tr>
			<th>
				<a href="#{{ store|replace({' ': '_'}) }}" data-toggle="collapse"><h2>{{ store }}</h2></a>
			</th>
		</tr>
		<tr>
			<td>
				<div id="{{ store|replace({' ': '_'}) }}" class="store collapse">
					{% for com_id, merchant in merchants %}
					<div class="merchant{{ (merchant) }}">
						<label><h3> {{ merchant.name }}</h3></label><br/>
						{% for order_id, order in merchant.orders %}
						<table style="width: 100%">
							<tr>
								<td style="width:40%">
									<a href="#{{ order_id ~ "-" ~ com_id }}" data-toggle="collapse">
										<label>{{ order_id ~" "~ order.first_name ~" "~ order.last_name }}</label>
									</a>
								</td>
								<td style="width:30%">
									<label>{{"Nombre d'articles : " ~ order.total_quantite }}</label>
								</td>
								<td style="width:30%">
									<label>{{"Total : " ~ order.total_prix ~ "€"}}</label>
								</td>
							</tr>
							<tr>
								<td colspan="3">
									<div id="{{ order_id ~ "-" ~ com_id }}" class="order collapse">
										<table class="table table-striped">
											<tr>
												<th>Produit</th>
												<th>Quantite</th>
												<th>Description</th>
												<th>Prix</th>
												<th>Total</th>
											</tr>
											{% for product in order.products %}
											<tr>
												<td>{{ product.nom }}</td>
												<td>{{ product.quantite }}</td>
												<td>{{ product.description }}</td>
												<td>{{ product.prix_unitaire ~"€ (" ~ product.prix_kilo~")" }}</td>
												<td>{{ product.prix_total ~"€" }}</td>
											</tr>
											{% endfor %}
											<tr>
												<td><b>TOTAL</b></td>
												<td colspan="3"><b>{{ order.total_quantite }}</b></td>
												<td colspan="2"><b>{{ order.total_prix }}</b></td>
											</tr>
										</table>
									</div>
								</td>
							</tr>
						</table>
						{% endfor %}
					</div>
					{%endfor%}
				</div>
			</td>
		</tr>
	</table>
	{% endfor %}
</div>								
{% endblock %}
